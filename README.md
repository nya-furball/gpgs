# gpgs

A user-friendly script to secure synchronous communications using ephemeral GPG keys.


### DISCLAIMER:

This tool is provided without any liability to the author or contributors of this project. </br>This tool and GPG are NOT SILVER BULLETS. Understand your situation, what you are trying accomplish, who are you up against and what can your adversaries do. The author of the program is NOT a cryptographer, nor can they offer professional advice in situations where lives are endangered due to disclosure of information/metadata and/or compromises in operational security. 

This tool is intended to be used by users with:

- moderate experience in Linux system administration/security
- detailed understanding of how GPG and the Web of Trust works

A understanding more than just a high level overview of how to use GPG is required. You need to understand how to use GPG practically against your adversaries in order to prevent fuck-ups during your communications process. It is also recommended for you to have a solid understanding of public key cryptography before using the script. The cryptography used in this tool is NOT quantum-resistant.


### Features and Limitations:

#### Limitations:
This script CANNOT: 

- Secure messages encrypted on a compromised client
- Protect you against untrustworthy recipients
- Prevent you from getting [MITMed](https://en.wikipedia.org/wiki/Man-in-the-middle_attack) IF you do not establish trust securely prior to using the script 
- Protect you AND/OR your recipient against being [rubber-hosed](https://en.wikipedia.org/wiki/Rubber-hose_cryptanalysis) (see xkcd [#538](https://xkcd.com/538/)) for specific message contents if an adversary knows enough context to determine what might be sent in the past 
- Protect against adversaries using quantum computers to recover encrypted messages captured in the past
- Protect your metadata

#### Features:
IF AND ONLY IF both clients (sender/receiver) are not compromised AND you are not being [MITMed](https://en.wikipedia.org/wiki/Man-in-the-middle_attack), this script CAN:

- Prevent recovery of your messages against conventional computers
- Protect messages against client compromise in the future
- Prevent you and your recipient against being [compelled to give up key material](https://en.wikipedia.org/wiki/Key_disclosure_law) (key pairs are in DRAM and passphrase is not exposed to user)

#### Compromise Criterion
A client is considered compromised in the scope of this project IF:

- Your adversary can capture your messages before it's encrypted, eg:
  - Malware running on OS
  - Hardware key-logger
  - [TEMPEST](https://en.wikipedia.org/wiki/Tempest_\(codename\)) attacks against a wireless keyboard
- Your adversary can recover the key-pairs and passphrase, eg:
  - key-pairs and/or passphrase get stored onto ANY TYPE of non-volatile medium, eg:
     - Intel(R) Optane(tm) DCPMM modules configured as system memory
     - Swapfile/partition on HDD or SSD
  - Admins gain access to the ephemeral GPG homedir on a multi-user system
  - Your VPS provider dumps the memory content and performs memory forensics



### Threat Model and Expectations:
(TODO)



### Example Case Study:

Alice and Bob would like to set up a method to indicate they are compromised while under coercion and active surveillance. Ideally, the decision is agreed upon and communicated without leaving traces or using ephemeral keys to prevent Eve from knowing enough context to [rubber-hose](https://en.wikipedia.org/wiki/Rubber-hose_cryptanalysis) Alice and/or Bob for their method. </br>To indicate compromise, both decide on using specific phrases and responses, which appear to be innocuous to observers who do not know the real context behind those phrases and the existence of said method. To prevent Eve from knowing the specifics, they both use ephemeral keys to prevent future recovery after being compromised and forced to turn over keys and access to their clients. </br>To prevent being [MITMed](https://en.wikipedia.org/wiki/Man-in-the-middle_attack) when exchanging ephemeral keys generated by this script, Alice and Bob exchange their long term GPG identities through a secure channel AND establish that those GPG identity keys actually belong to their respective owners. </br>After establishing trust, both Alice and generate an ephemeral key in the script. Alice signs her ephemeral key with her identity key, and encrypts the ephemeral key to Bob's identity key. Bob decrypts Alice's ephemeral key using his identity key and verifies Alice's signature. He then imports Alice's ephemeral key into the script and signs his ephemeral key with his identity key, and encrypts it to Alice's ephemeral key. Alice decrypts Bob's ephemeral key using the script and verifies Bob's signature. She then imports Bob's ephemeral key into the script. </br>From this point on, both of them encrypt to their respective ephemeral keys using the script to discuss what phrases to use when indicating compromise. After deciding on the phrases and practicing, both quit the script and carry on with their business.



### Improvements and Bug-fixes!
If you find any oversights or flaws in the overall threat model, cryptography or implementation, PLEASE FILE AN ISSUE! Everyone is welcome to audit this tool, no matter if you're a enthusiast, cipherpunk, or a professional cryptologist! I am very happy to discuss those shortfalls and improve the overall implementation! Also, feel free to file issues if you find bugs in the software or you would like to suggest improvements in the UI!

#### README TODO
- Threat model and expectations 
- Commands and Syntax